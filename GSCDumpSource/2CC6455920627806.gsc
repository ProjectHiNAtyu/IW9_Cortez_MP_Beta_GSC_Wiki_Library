// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

_id_476BA78D85B349EA()
{
    level._id_9F17D605C510C3F7 = getdvarint( "dvar_823C57EC4DAC4069", 4 ) - 1;
    scripts\engine\scriptable::scriptable_addusedcallbackbypart( "body_dead_drop", ::_id_53E98CB7BEF92233 );
}

_id_53E98CB7BEF92233( instance, part, state, player, _id_A5B2C541413AA895, _id_CC38472E36BE1B61 )
{
    player._id_1F8CD0CE903FF0DA = 1;

    if ( !isdefined( player._id_5621109F5EF8AB48 ) )
    {
        player._id_5621109F5EF8AB48 = spawnstruct();
        player._id_5621109F5EF8AB48.contents = [];
        player._id_5621109F5EF8AB48.contents[0] = [];
        player._id_5621109F5EF8AB48.contents[0]["quantity"] = 0;
        player._id_5621109F5EF8AB48.contents[0]["lootID"] = 0;
        player._id_5621109F5EF8AB48._id_04F6CDE716E0C3D7 = 0;
        player._id_5621109F5EF8AB48._id_6FB67C8525B1D79E = undefined;
    }

    if ( !isdefined( instance._id_46A3A8565AC0C17C ) )
        instance._id_46A3A8565AC0C17C = 11;

    instance._id_2BC73315BD31809C[player.guid] = player;

    if ( instance getscriptablepartstate( "body_dead_drop" ) != "partially_opening_unusable" )
        instance setscriptablepartstate( "body_dead_drop", "partially_opening_unusable" );

    _id_5009AD19B081A3B2( player, instance );
}

_id_5009AD19B081A3B2( opener, _id_69E96A4CAA72D794 )
{
    _id_69E96A4CAA72D794.contents = opener._id_5621109F5EF8AB48.contents;
    [items, _id_77DC0A100921C5A7] = scripts\mp\loot::_id_0438749EB7A7B738( _id_69E96A4CAA72D794.contents, opener, _id_69E96A4CAA72D794 );
    _id_69E96A4CAA72D794.contents = items;
    opener._id_5621109F5EF8AB48.contents = items;
    opener._id_02FA5B49969DEF47 = _id_69E96A4CAA72D794;
    opener._id_F2AA9AE949179907 = opener.origin;

    if ( isdefined( _id_69E96A4CAA72D794.parent ) )
        opener._id_F2AA9AE949179907 = opener.origin - _id_69E96A4CAA72D794.parent.origin;

    if ( items.size > level._id_9F17D605C510C3F7 )
    {

    }

    for ( _id_3793828403C6873E = 0; _id_3793828403C6873E < level._id_9F17D605C510C3F7; _id_3793828403C6873E++ )
    {
        if ( _id_3793828403C6873E <= _id_77DC0A100921C5A7 )
        {
            scripts\mp\loot::_id_446C7AD7BCC70992( opener, _id_3793828403C6873E, items[_id_3793828403C6873E]["lootID"], items[_id_3793828403C6873E]["quantity"] );
            continue;
        }

        scripts\mp\loot::_id_C7294F5B9B5006D5( opener, _id_3793828403C6873E );
    }

    if ( isdefined( opener._id_5621109F5EF8AB48._id_04F6CDE716E0C3D7 ) )
        opener setclientomnvar( "loot_container_weapon", opener._id_5621109F5EF8AB48._id_04F6CDE716E0C3D7 );

    opener setclientomnvar( "loot_container_open", _id_69E96A4CAA72D794._id_46A3A8565AC0C17C );
    _id_69E96A4CAA72D794 thread scripts\mp\loot::_id_71A59F067D5FE986( _id_69E96A4CAA72D794, opener );
    _id_69E96A4CAA72D794 thread scripts\mp\loot::_id_47B931D76FFD028F( _id_69E96A4CAA72D794, opener );
}

_id_CCF376D186ABE51F( itemtype, _id_3793828403C6873E )
{
    self._id_02FA5B49969DEF47.contents = self._id_5621109F5EF8AB48.contents;
    [items, _id_77DC0A100921C5A7] = scripts\mp\loot::_id_0438749EB7A7B738( self._id_02FA5B49969DEF47.contents, self, self._id_02FA5B49969DEF47 );
    self._id_02FA5B49969DEF47.contents = items;
    self._id_5621109F5EF8AB48.contents = items;

    for ( _id_AC0E594AC96AA3A8 = _id_77DC0A100921C5A7 + 1; _id_AC0E594AC96AA3A8 < self._id_02FA5B49969DEF47.contents.size; _id_AC0E594AC96AA3A8++ )
        self._id_02FA5B49969DEF47.contents[_id_AC0E594AC96AA3A8] = undefined;

    if ( istrue( self getclientomnvar( "loot_container_weapon" ) ) && itemtype == 1 )
    {
        scripts\mp\hud_message::showerrormessage( "MP/BALLOON_EXTRACT_DENY_NO_ROOM" );
        return;
    }

    [lootid, quantity, weaponobj] = _id_1D393929CF0BD6A2::_id_CBCA59C109AE17AF( itemtype, _id_3793828403C6873E );

    if ( itemtype == 1 && isdefined( weaponobj ) )
    {
        scripts\mp\loot::_id_67BE8D119FA22135( self, self._id_5621109F5EF8AB48, weaponobj, lootid, itemtype, _id_3793828403C6873E );
        return;
    }

    _id_D54A79024C228770 = self._id_02FA5B49969DEF47.contents.size;
    _id_7745D84DFCF3F0FB = undefined;

    foreach ( index, item in self._id_02FA5B49969DEF47.contents )
    {
        if ( !isdefined( item ) || !isdefined( item["quantity"] ) || !isdefined( item["lootID"] ) )
            continue;

        if ( item["lootID"] == 200047 && lootid == item["lootID"] )
        {
            _id_D54A79024C228770 = index;
            quantity = quantity + item["quantity"];
            _id_7745D84DFCF3F0FB = 1;
            break;
        }

        scriptablename = _id_600B944A95C3A7BF::_id_E1D5A33193DB0133( lootid );
        maxcount = level.br_pickups._id_04138F9DDC1CD22D[scriptablename];

        if ( !isdefined( maxcount ) || maxcount == 0 )
            maxcount = level.br_pickups.maxcounts[scriptablename];

        if ( !isdefined( maxcount ) || maxcount == 0 )
            continue;

        if ( item["lootID"] == lootid && quantity + item["quantity"] <= maxcount )
        {
            _id_D54A79024C228770 = index;
            quantity = quantity + item["quantity"];
            _id_7745D84DFCF3F0FB = 1;
            break;
        }
    }

    if ( _id_D54A79024C228770 >= level._id_9F17D605C510C3F7 && itemtype != 1 && !istrue( _id_7745D84DFCF3F0FB ) )
    {
        scripts\mp\hud_message::showerrormessage( "MP/BALLOON_EXTRACT_DENY_NO_ROOM" );
        return;
    }

    _id_DFAB44D4D8D10B36 = quantity;

    if ( itemtype == 10 )
        _id_DFAB44D4D8D10B36 = _id_2D9D24F7C63AC143::_id_897B29ADB37F06A7( _id_3793828403C6873E );

    self notify( "item_added_to_cache", itemtype, _id_3793828403C6873E, lootid, _id_DFAB44D4D8D10B36 );
    thread _id_7E52B56769FA7774::quickdropitem( itemtype, _id_3793828403C6873E, 1 );
    self._id_02FA5B49969DEF47.contents[_id_D54A79024C228770]["quantity"] = quantity;
    self._id_02FA5B49969DEF47.contents[_id_D54A79024C228770]["lootID"] = lootid;
    self._id_5621109F5EF8AB48.contents[_id_D54A79024C228770]["quantity"] = quantity;
    self._id_5621109F5EF8AB48.contents[_id_D54A79024C228770]["lootID"] = lootid;
    thread _id_551E130922F441E1( self, self._id_02FA5B49969DEF47 );
}

_id_551E130922F441E1( opener, _id_69E96A4CAA72D794 )
{
    _id_69E96A4CAA72D794.contents = opener._id_5621109F5EF8AB48.contents;
    [items, _id_77DC0A100921C5A7] = scripts\mp\loot::_id_0438749EB7A7B738( _id_69E96A4CAA72D794.contents, opener, _id_69E96A4CAA72D794 );
    _id_69E96A4CAA72D794.contents = items;
    self._id_5621109F5EF8AB48.contents = items;

    if ( items.size > level._id_9F17D605C510C3F7 )
    {

    }

    for ( _id_3793828403C6873E = 0; _id_3793828403C6873E < level._id_9F17D605C510C3F7; _id_3793828403C6873E++ )
        scripts\mp\loot::_id_C7294F5B9B5006D5( opener, _id_3793828403C6873E );

    for ( _id_3793828403C6873E = 0; _id_3793828403C6873E < level._id_9F17D605C510C3F7; _id_3793828403C6873E++ )
    {
        if ( _id_3793828403C6873E <= _id_77DC0A100921C5A7 )
            scripts\mp\loot::_id_446C7AD7BCC70992( opener, _id_3793828403C6873E, items[_id_3793828403C6873E]["lootID"], items[_id_3793828403C6873E]["quantity"] );
    }

    opener._id_1F8CD0CE903FF0DA = 1;
}

_id_B5399746EAA8316C()
{
    self setscriptablepartstate( "body_dead_drop", "partially_closing_unusable" );

    foreach ( player in self._id_2BC73315BD31809C )
    {
        if ( !isdefined( player._id_5621109F5EF8AB48 ) )
            continue;

        _id_E1CF43F3AE9D77E7 = _id_1D393929CF0BD6A2::_id_9E02F22DECAAAF1F( player._id_5621109F5EF8AB48.contents );
        _id_BBAC576AADE31A1E = 0;

        foreach ( item in _id_E1CF43F3AE9D77E7 )
        {
            if ( !isdefined( item.lootid ) )
                continue;

            ref = _id_600B944A95C3A7BF::_id_793E8A72CEDB8EF3( item.lootid );
            _id_25978461C6E4F61B = level.br_pickups._id_838863C4848D4C26[ref];
            itemtype = undefined;

            if ( isdefined( _id_25978461C6E4F61B ) )
                itemtype = level.br_pickups.br_itemtype[_id_25978461C6E4F61B];

            if ( isdefined( itemtype ) && itemtype == "plunder" )
                _id_BBAC576AADE31A1E = _id_BBAC576AADE31A1E + item.quantity;
        }

        _id_B8F5D813D9E1194E = undefined;
        _id_98F7CE981BB1F93C = player getclientomnvar( "loot_container_weapon" );

        if ( istrue( _id_98F7CE981BB1F93C ) )
        {
            _id_B8F5D813D9E1194E = spawnstruct();
            _id_B8F5D813D9E1194E.lootid = _id_98F7CE981BB1F93C;
            _id_B8F5D813D9E1194E.quantity = 1;
            _id_E1CF43F3AE9D77E7[_id_E1CF43F3AE9D77E7.size] = _id_B8F5D813D9E1194E;
        }

        _id_3EAA9F644DBE7834 = 0;
        _id_3EAA9F644DBE7834 = scripts\cp_mp\challenges::_id_6D40F12A09494350( _id_3EAA9F644DBE7834, 7 );

        if ( !_id_6A8EC730B2BFA844::_id_6F6CC16C0528DE5B( player ) )
        {
            player._id_5621109F5EF8AB48 = undefined;
            return;
        }

        _id_A95035097821E2D1 = [];

        foreach ( item in _id_E1CF43F3AE9D77E7 )
        {
            ref = _id_600B944A95C3A7BF::_id_793E8A72CEDB8EF3( item.lootid );
            _id_25978461C6E4F61B = level.br_pickups._id_838863C4848D4C26[ref];
            itemtype = undefined;

            if ( isdefined( _id_25978461C6E4F61B ) )
                itemtype = level.br_pickups.br_itemtype[_id_25978461C6E4F61B];

            quantity = item.quantity;

            if ( !isdefined( item.quantity ) )
                quantity = 1;

            scripts\cp_mp\challenges::_id_D24138B32084FC3E( player, item.lootid, undefined, _id_3EAA9F644DBE7834, quantity );
        }

        scripts\cp_mp\challenges::_id_D24138B32084FC3E( player, 200047, undefined, _id_3EAA9F644DBE7834, _id_BBAC576AADE31A1E * 100 );

        for ( _id_AC0E594AC96AA3A8 = 0; _id_AC0E594AC96AA3A8 < 110; _id_AC0E594AC96AA3A8++ )
        {
            cooldowntime = player getplayerdata( level._id_5D69837CF4DB0407, "dmzInventory", _id_AC0E594AC96AA3A8, "cooldownEndTime" );

            if ( cooldowntime > getsystemtime() )
            {
                _id_3DB0926F7A996BC9 = player getplayerdata( level._id_5D69837CF4DB0407, "dmzInventory", _id_AC0E594AC96AA3A8, "cooldownEndTime" ) - int( 3600 * _id_BBAC576AADE31A1E / getdvarint( "dvar_C5AC098E3A15AF33", 50 ) );

                if ( _id_3DB0926F7A996BC9 <= getsystemtime() )
                    player setplayerdata( level._id_5D69837CF4DB0407, "dmzInventory", _id_AC0E594AC96AA3A8, "cooldownEndTime", 0 );
                else
                    player setplayerdata( level._id_5D69837CF4DB0407, "dmzInventory", _id_AC0E594AC96AA3A8, "cooldownEndTime", _id_3DB0926F7A996BC9 );
            }
        }

        player setclientomnvar( "loot_container_weapon", 0 );
    }
}
